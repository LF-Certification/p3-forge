:80 {
    # Enable detailed logs
    log {
        output stdout
        format console
        level DEBUG
    }

    # Root path serves static files
    root * /usr/share/caddy/dist
    file_server

    # Serve config.json
    handle /config.json {
        root * /usr/share/caddy
        file_server
    }

    # Handle /terminal (redirect to /terminal/)
    @terminal path /terminal
    handle @terminal {
        redir /terminal/ permanent
    }

    # Terminal proxy with path rewriting
    handle_path /terminal/* {
        reverse_proxy ttyd:7681
    }

    # Handle /terminal2 (redirect to /terminal2/)
    @terminal2 path /terminal2
    handle @terminal2 {
        redir /terminal2/ permanent
    }

    # Second terminal proxy with path rewriting
    handle_path /terminal2/* {
        reverse_proxy ttyd2:7681
    }

    # Handle /vscode (redirect to /vscode/)
    @vscode path /vscode
    handle @vscode {
        redir /vscode/ permanent
    }

    # VS Code proxy
    handle_path /vscode/* {
        reverse_proxy code-server:8080
    }
}
